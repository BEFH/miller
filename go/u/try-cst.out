

----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put 
a   b   i x                   y
pan pan 1 0.3467901443380824  0.7268028627434533
eks pan 2 0.7586799647899636  0.5221511083334797
wye wye 3 0.20460330576630303 0.33831852551664776
eks wye 4 0.38139939387114097 0.13418874328430463


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $j=$i+$i
a   b   i x                   y                   j
pan pan 1 0.3467901443380824  0.7268028627434533  2
eks pan 2 0.7586799647899636  0.5221511083334797  4
wye wye 3 0.20460330576630303 0.33831852551664776 6
eks wye 4 0.38139939387114097 0.13418874328430463 8


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $j=$i+$x
a   b   i x                   y                   j
pan pan 1 0.3467901443380824  0.7268028627434533  1.3467901443380823
eks pan 2 0.7586799647899636  0.5221511083334797  2.7586799647899634
wye wye 3 0.20460330576630303 0.33831852551664776 3.204603305766303
eks wye 4 0.38139939387114097 0.13418874328430463 4.381399393871141


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $j=$y+$x
a   b   i x                   y                   j
pan pan 1 0.3467901443380824  0.7268028627434533  1.0735930070815356
eks pan 2 0.7586799647899636  0.5221511083334797  1.2808310731234434
wye wye 3 0.20460330576630303 0.33831852551664776 0.5429218312829508
eks wye 4 0.38139939387114097 0.13418874328430463 0.5155881371554456


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $j=$y+$i
a   b   i x                   y                   j
pan pan 1 0.3467901443380824  0.7268028627434533  1.7268028627434533
eks pan 2 0.7586799647899636  0.5221511083334797  2.5221511083334796
wye wye 3 0.20460330576630303 0.33831852551664776 3.3383185255166477
eks wye 4 0.38139939387114097 0.13418874328430463 4.134188743284304


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $j=$y+$y
a   b   i x                   y                   j
pan pan 1 0.3467901443380824  0.7268028627434533  1.4536057254869066
eks pan 2 0.7586799647899636  0.5221511083334797  1.0443022166669593
wye wye 3 0.20460330576630303 0.33831852551664776 0.6766370510332955
eks wye 4 0.38139939387114097 0.13418874328430463 0.26837748656860927


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $j=$i+$i
a   b   i x                   y                   j
pan pan 1 0.3467901443380824  0.7268028627434533  2
eks pan 2 0.7586799647899636  0.5221511083334797  4
wye wye 3 0.20460330576630303 0.33831852551664776 6
eks wye 4 0.38139939387114097 0.13418874328430463 8


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $y=$x*1e6
a   b   i x                   y
pan pan 1 0.3467901443380824  346790.1443380824
eks pan 2 0.7586799647899636  758679.9647899636
wye wye 3 0.20460330576630303 204603.30576630303
eks wye 4 0.38139939387114097 381399.39387114096


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $y=$x+1e6
a   b   i x                   y
pan pan 1 0.3467901443380824  1.0000003467901443e+06
eks pan 2 0.7586799647899636  1.0000007586799648e+06
wye wye 3 0.20460330576630303 1.0000002046033058e+06
eks wye 4 0.38139939387114097 1.0000003813993939e+06


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $y=$x+1
a   b   i x                   y
pan pan 1 0.3467901443380824  1.3467901443380823
eks pan 2 0.7586799647899636  1.7586799647899636
wye wye 3 0.20460330576630303 1.204603305766303
eks wye 4 0.38139939387114097 1.381399393871141


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $y=FILENAME
a   b   i x                   y
pan pan 1 0.3467901443380824  u/s.dkvp
eks pan 2 0.7586799647899636  u/s.dkvp
wye wye 3 0.20460330576630303 u/s.dkvp
eks wye 4 0.38139939387114097 u/s.dkvp


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $y=FILENUM
a   b   i x                   y
pan pan 1 0.3467901443380824  1
eks pan 2 0.7586799647899636  1
wye wye 3 0.20460330576630303 1
eks wye 4 0.38139939387114097 1


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $y=NF
a   b   i x                   y
pan pan 1 0.3467901443380824  5
eks pan 2 0.7586799647899636  5
wye wye 3 0.20460330576630303 5
eks wye 4 0.38139939387114097 5


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $y=NR
a   b   i x                   y
pan pan 1 0.3467901443380824  1
eks pan 2 0.7586799647899636  2
wye wye 3 0.20460330576630303 3
eks wye 4 0.38139939387114097 4


----------------------------------------------------------------
mlr --idkvp --opprint put $y=FNR u/s.dkvp u/t.dkvp
a   b   i x                   y
pan pan 1 0.3467901443380824  1
eks pan 2 0.7586799647899636  2
wye wye 3 0.20460330576630303 3
eks wye 4 0.38139939387114097 4
wye pan 5 0.5732889198020006  1
zee pan 6 0.5271261600918548  2
eks zee 7 0.6117840605678454  3


----------------------------------------------------------------
mlr --idkvp --opprint put $y=NR u/s.dkvp u/t.dkvp
a   b   i x                   y
pan pan 1 0.3467901443380824  1
eks pan 2 0.7586799647899636  2
wye wye 3 0.20460330576630303 3
eks wye 4 0.38139939387114097 4
wye pan 5 0.5732889198020006  5
zee pan 6 0.5271261600918548  6
eks zee 7 0.6117840605678454  7


----------------------------------------------------------------
mlr --icsv --opprint put $y=FNR u/s.csv u/t.csv
a   b   i x                   y
pan pan 1 0.3467901443380824  1
eks pan 2 0.7586799647899636  2
wye wye 3 0.20460330576630303 3
eks wye 4 0.38139939387114097 4
wye pan 5 0.5732889198020006  1
zee pan 6 0.5271261600918548  2
eks zee 7 0.6117840605678454  3


----------------------------------------------------------------
mlr --idkvp --opprint put $y=FNR+1 u/s.dkvp u/t.dkvp
a   b   i x                   y
pan pan 1 0.3467901443380824  2
eks pan 2 0.7586799647899636  3
wye wye 3 0.20460330576630303 4
eks wye 4 0.38139939387114097 5
wye pan 5 0.5732889198020006  2
zee pan 6 0.5271261600918548  3
eks zee 7 0.6117840605678454  4


----------------------------------------------------------------
mlr --idkvp --opprint put $y=FNR+$i u/s.dkvp u/t.dkvp
a   b   i x                   y
pan pan 1 0.3467901443380824  2
eks pan 2 0.7586799647899636  4
wye wye 3 0.20460330576630303 6
eks wye 4 0.38139939387114097 8
wye pan 5 0.5732889198020006  6
zee pan 6 0.5271261600918548  8
eks zee 7 0.6117840605678454  10


----------------------------------------------------------------
mlr --idkvp --opprint put $y=FNR+3 u/s.dkvp u/t.dkvp
a   b   i x                   y
pan pan 1 0.3467901443380824  4
eks pan 2 0.7586799647899636  5
wye wye 3 0.20460330576630303 6
eks wye 4 0.38139939387114097 7
wye pan 5 0.5732889198020006  4
zee pan 6 0.5271261600918548  5
eks zee 7 0.6117840605678454  6


----------------------------------------------------------------
mlr --idkvp --opprint put $y=FNR+3+$i u/s.dkvp u/t.dkvp
a   b   i x                   y
pan pan 1 0.3467901443380824  5
eks pan 2 0.7586799647899636  7
wye wye 3 0.20460330576630303 9
eks wye 4 0.38139939387114097 11
wye pan 5 0.5732889198020006  9
zee pan 6 0.5271261600918548  11
eks zee 7 0.6117840605678454  13


----------------------------------------------------------------
mlr --idkvp --opprint put $y=$i+$y u/s.dkvp u/t.dkvp
a   b   i x                   y
pan pan 1 0.3467901443380824  1.7268028627434533
eks pan 2 0.7586799647899636  2.5221511083334796
wye wye 3 0.20460330576630303 3.3383185255166477
eks wye 4 0.38139939387114097 4.134188743284304
wye pan 5 0.5732889198020006  5.863624469903273
zee pan 6 0.5271261600918548  6.493221286748357
eks zee 7 0.6117840605678454  7.1878849191181695


----------------------------------------------------------------
mlr --idkvp --opprint put $y=$i+$x u/s.dkvp u/t.dkvp
a   b   i x                   y
pan pan 1 0.3467901443380824  1.3467901443380823
eks pan 2 0.7586799647899636  2.7586799647899634
wye wye 3 0.20460330576630303 3.204603305766303
eks wye 4 0.38139939387114097 4.381399393871141
wye pan 5 0.5732889198020006  5.573288919802001
zee pan 6 0.5271261600918548  6.527126160091854
eks zee 7 0.6117840605678454  7.611784060567845


----------------------------------------------------------------
mlr --idkvp --opprint put $z=$x+$y u/s.dkvp u/t.dkvp
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  1.0735930070815356
eks pan 2 0.7586799647899636  0.5221511083334797  1.2808310731234434
wye wye 3 0.20460330576630303 0.33831852551664776 0.5429218312829508
eks wye 4 0.38139939387114097 0.13418874328430463 0.5155881371554456
wye pan 5 0.5732889198020006  0.8636244699032729  1.4369133897052735
zee pan 6 0.5271261600918548  0.49322128674835697 1.0203474468402116
eks zee 7 0.6117840605678454  0.1878849191181694  0.7996689796860148


----------------------------------------------------------------
mlr --idkvp --opprint put $z=$x+$i u/s.dkvp u/t.dkvp
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  1.3467901443380823
eks pan 2 0.7586799647899636  0.5221511083334797  2.7586799647899634
wye wye 3 0.20460330576630303 0.33831852551664776 3.204603305766303
eks wye 4 0.38139939387114097 0.13418874328430463 4.381399393871141
wye pan 5 0.5732889198020006  0.8636244699032729  5.573288919802001
zee pan 6 0.5271261600918548  0.49322128674835697 6.527126160091854
eks zee 7 0.6117840605678454  0.1878849191181694  7.611784060567845


----------------------------------------------------------------
mlr --idkvp --opprint put $z=NR+$i u/s.dkvp u/t.dkvp
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  2
eks pan 2 0.7586799647899636  0.5221511083334797  4
wye wye 3 0.20460330576630303 0.33831852551664776 6
eks wye 4 0.38139939387114097 0.13418874328430463 8
wye pan 5 0.5732889198020006  0.8636244699032729  10
zee pan 6 0.5271261600918548  0.49322128674835697 12
eks zee 7 0.6117840605678454  0.1878849191181694  14


----------------------------------------------------------------
mlr --idkvp --opprint put $z=NR-$i u/s.dkvp u/t.dkvp
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  0
eks pan 2 0.7586799647899636  0.5221511083334797  0
wye wye 3 0.20460330576630303 0.33831852551664776 0
eks wye 4 0.38139939387114097 0.13418874328430463 0
wye pan 5 0.5732889198020006  0.8636244699032729  0
zee pan 6 0.5271261600918548  0.49322128674835697 0
eks zee 7 0.6117840605678454  0.1878849191181694  0


----------------------------------------------------------------
mlr --idkvp --opprint put $z=4-1 u/s.dkvp u/t.dkvp
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  3
eks pan 2 0.7586799647899636  0.5221511083334797  3
wye wye 3 0.20460330576630303 0.33831852551664776 3
eks wye 4 0.38139939387114097 0.13418874328430463 3
wye pan 5 0.5732889198020006  0.8636244699032729  3
zee pan 6 0.5271261600918548  0.49322128674835697 3
eks zee 7 0.6117840605678454  0.1878849191181694  3


----------------------------------------------------------------
mlr --idkvp --opprint put $z=NR u/s.dkvp u/t.dkvp
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  1
eks pan 2 0.7586799647899636  0.5221511083334797  2
wye wye 3 0.20460330576630303 0.33831852551664776 3
eks wye 4 0.38139939387114097 0.13418874328430463 4
wye pan 5 0.5732889198020006  0.8636244699032729  5
zee pan 6 0.5271261600918548  0.49322128674835697 6
eks zee 7 0.6117840605678454  0.1878849191181694  7


----------------------------------------------------------------
mlr --idkvp --opprint put $z=$i u/s.dkvp u/t.dkvp
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  1
eks pan 2 0.7586799647899636  0.5221511083334797  2
wye wye 3 0.20460330576630303 0.33831852551664776 3
eks wye 4 0.38139939387114097 0.13418874328430463 4
wye pan 5 0.5732889198020006  0.8636244699032729  5
zee pan 6 0.5271261600918548  0.49322128674835697 6
eks zee 7 0.6117840605678454  0.1878849191181694  7


----------------------------------------------------------------
mlr --idkvp --opprint put $z=100*NR-$i u/s.dkvp u/t.dkvp
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  99
eks pan 2 0.7586799647899636  0.5221511083334797  198
wye wye 3 0.20460330576630303 0.33831852551664776 297
eks wye 4 0.38139939387114097 0.13418874328430463 396
wye pan 5 0.5732889198020006  0.8636244699032729  495
zee pan 6 0.5271261600918548  0.49322128674835697 594
eks zee 7 0.6117840605678454  0.1878849191181694  693


----------------------------------------------------------------
mlr --idkvp --opprint put $z=100*$i+$x u/s.dkvp u/t.dkvp
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  100.34679014433809
eks pan 2 0.7586799647899636  0.5221511083334797  200.75867996478996
wye wye 3 0.20460330576630303 0.33831852551664776 300.2046033057663
eks wye 4 0.38139939387114097 0.13418874328430463 400.38139939387116
wye pan 5 0.5732889198020006  0.8636244699032729  500.573288919802
zee pan 6 0.5271261600918548  0.49322128674835697 600.5271261600918
eks zee 7 0.6117840605678454  0.1878849191181694  700.6117840605679


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z=100*$i+$x
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  100.34679014433809
eks pan 2 0.7586799647899636  0.5221511083334797  200.75867996478996
wye wye 3 0.20460330576630303 0.33831852551664776 300.2046033057663
eks wye 4 0.38139939387114097 0.13418874328430463 400.38139939387116


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z=100*$i/$x
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  288.3588292016481
eks pan 2 0.7586799647899636  0.5221511083334797  263.6157659117424
wye wye 3 0.20460330576630303 0.33831852551664776 1466.2519692749179
eks wye 4 0.38139939387114097 0.13418874328430463 1048.769364681118


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z=NR/$i
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  1
eks pan 2 0.7586799647899636  0.5221511083334797  1
wye wye 3 0.20460330576630303 0.33831852551664776 1
eks wye 4 0.38139939387114097 0.13418874328430463 1


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z=100/$i
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  100
eks pan 2 0.7586799647899636  0.5221511083334797  50
wye wye 3 0.20460330576630303 0.33831852551664776 33.333333333333336
eks wye 4 0.38139939387114097 0.13418874328430463 25


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z=100//$i
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  100
eks pan 2 0.7586799647899636  0.5221511083334797  50
wye wye 3 0.20460330576630303 0.33831852551664776 33
eks wye 4 0.38139939387114097 0.13418874328430463 25


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z=100//$x
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  288
eks pan 2 0.7586799647899636  0.5221511083334797  131
wye wye 3 0.20460330576630303 0.33831852551664776 488
eks wye 4 0.38139939387114097 0.13418874328430463 262


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z=100.0//$i
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  100
eks pan 2 0.7586799647899636  0.5221511083334797  50
wye wye 3 0.20460330576630303 0.33831852551664776 33
eks wye 4 0.38139939387114097 0.13418874328430463 25


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z=100.0//$i
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  100
eks pan 2 0.7586799647899636  0.5221511083334797  50
wye wye 3 0.20460330576630303 0.33831852551664776 33
eks wye 4 0.38139939387114097 0.13418874328430463 25


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z=100.0/$i
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  100
eks pan 2 0.7586799647899636  0.5221511083334797  50
wye wye 3 0.20460330576630303 0.33831852551664776 33.333333333333336
eks wye 4 0.38139939387114097 0.13418874328430463 25


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z=100.0
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  100.0
eks pan 2 0.7586799647899636  0.5221511083334797  100.0
wye wye 3 0.20460330576630303 0.33831852551664776 100.0
eks wye 4 0.38139939387114097 0.13418874328430463 100.0


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z=100
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  100
eks pan 2 0.7586799647899636  0.5221511083334797  100
wye wye 3 0.20460330576630303 0.33831852551664776 100
eks wye 4 0.38139939387114097 0.13418874328430463 100


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z=100.4
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  100.4
eks pan 2 0.7586799647899636  0.5221511083334797  100.4
wye wye 3 0.20460330576630303 0.33831852551664776 100.4
eks wye 4 0.38139939387114097 0.13418874328430463 100.4


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z=1.2
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  1.2
eks pan 2 0.7586799647899636  0.5221511083334797  1.2
wye wye 3 0.20460330576630303 0.33831852551664776 1.2
eks wye 4 0.38139939387114097 0.13418874328430463 1.2


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z=100.0/$i
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  100
eks pan 2 0.7586799647899636  0.5221511083334797  50
wye wye 3 0.20460330576630303 0.33831852551664776 33.333333333333336
eks wye 4 0.38139939387114097 0.13418874328430463 25


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z=100.0//$i
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  100
eks pan 2 0.7586799647899636  0.5221511083334797  50
wye wye 3 0.20460330576630303 0.33831852551664776 33
eks wye 4 0.38139939387114097 0.13418874328430463 25


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z=0x7fffffffffffffff  + 0x7fffffffffffffff
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  1.8446744073709552e+19
eks pan 2 0.7586799647899636  0.5221511083334797  1.8446744073709552e+19
wye wye 3 0.20460330576630303 0.33831852551664776 1.8446744073709552e+19
eks wye 4 0.38139939387114097 0.13418874328430463 1.8446744073709552e+19


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z=0x7fffffffffffffff .+ 0x7fffffffffffffff
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  -2
eks pan 2 0.7586799647899636  0.5221511083334797  -2
wye wye 3 0.20460330576630303 0.33831852551664776 -2
eks wye 4 0.38139939387114097 0.13418874328430463 -2


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z=0x7fffffffffffffff  * 0x7fffffffffffffff
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  8.507059173023462e+37
eks pan 2 0.7586799647899636  0.5221511083334797  8.507059173023462e+37
wye wye 3 0.20460330576630303 0.33831852551664776 8.507059173023462e+37
eks wye 4 0.38139939387114097 0.13418874328430463 8.507059173023462e+37


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z=0x7fffffffffffffff .* 0x7fffffffffffffff
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  1
eks pan 2 0.7586799647899636  0.5221511083334797  1
wye wye 3 0.20460330576630303 0.33831852551664776 1
eks wye 4 0.38139939387114097 0.13418874328430463 1


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z= (~ $i) + 1
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  -1
eks pan 2 0.7586799647899636  0.5221511083334797  -2
wye wye 3 0.20460330576630303 0.33831852551664776 -3
eks wye 4 0.38139939387114097 0.13418874328430463 -4


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z= $i == 2
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  false
eks pan 2 0.7586799647899636  0.5221511083334797  true
wye wye 3 0.20460330576630303 0.33831852551664776 false
eks wye 4 0.38139939387114097 0.13418874328430463 false


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z= $i != 2
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  true
eks pan 2 0.7586799647899636  0.5221511083334797  false
wye wye 3 0.20460330576630303 0.33831852551664776 true
eks wye 4 0.38139939387114097 0.13418874328430463 true


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z= $i >  2
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  false
eks pan 2 0.7586799647899636  0.5221511083334797  false
wye wye 3 0.20460330576630303 0.33831852551664776 true
eks wye 4 0.38139939387114097 0.13418874328430463 true


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z= $i >= 2
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  false
eks pan 2 0.7586799647899636  0.5221511083334797  true
wye wye 3 0.20460330576630303 0.33831852551664776 true
eks wye 4 0.38139939387114097 0.13418874328430463 true


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z= $i <  2
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  true
eks pan 2 0.7586799647899636  0.5221511083334797  false
wye wye 3 0.20460330576630303 0.33831852551664776 false
eks wye 4 0.38139939387114097 0.13418874328430463 false


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z= $i >= 2
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  false
eks pan 2 0.7586799647899636  0.5221511083334797  true
wye wye 3 0.20460330576630303 0.33831852551664776 true
eks wye 4 0.38139939387114097 0.13418874328430463 true


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = $i < 5 ? "low" : "high"
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  low
eks pan 2 0.7586799647899636  0.5221511083334797  low
wye wye 3 0.20460330576630303 0.33831852551664776 low
eks wye 4 0.38139939387114097 0.13418874328430463 low


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = $i ** 3
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  1
eks pan 2 0.7586799647899636  0.5221511083334797  8
wye wye 3 0.20460330576630303 0.33831852551664776 27
eks wye 4 0.38139939387114097 0.13418874328430463 64


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = $x ** 0.5
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  0.5888889066182877
eks pan 2 0.7586799647899636  0.5221511083334797  0.871022367560078
wye wye 3 0.20460330576630303 0.33831852551664776 0.45233096927615185
eks wye 4 0.38139939387114097 0.13418874328430463 0.6175754155333104


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = true  && true
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  true
eks pan 2 0.7586799647899636  0.5221511083334797  true
wye wye 3 0.20460330576630303 0.33831852551664776 true
eks wye 4 0.38139939387114097 0.13418874328430463 true


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = true  && false
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  false
eks pan 2 0.7586799647899636  0.5221511083334797  false
wye wye 3 0.20460330576630303 0.33831852551664776 false
eks wye 4 0.38139939387114097 0.13418874328430463 false


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = false && true
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  false
eks pan 2 0.7586799647899636  0.5221511083334797  false
wye wye 3 0.20460330576630303 0.33831852551664776 false
eks wye 4 0.38139939387114097 0.13418874328430463 false


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = false && false
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  false
eks pan 2 0.7586799647899636  0.5221511083334797  false
wye wye 3 0.20460330576630303 0.33831852551664776 false
eks wye 4 0.38139939387114097 0.13418874328430463 false


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = true  && 4
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  (error)
eks pan 2 0.7586799647899636  0.5221511083334797  (error)
wye wye 3 0.20460330576630303 0.33831852551664776 (error)
eks wye 4 0.38139939387114097 0.13418874328430463 (error)


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = false && 4
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  false
eks pan 2 0.7586799647899636  0.5221511083334797  false
wye wye 3 0.20460330576630303 0.33831852551664776 false
eks wye 4 0.38139939387114097 0.13418874328430463 false


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = 4     && true
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  (error)
eks pan 2 0.7586799647899636  0.5221511083334797  (error)
wye wye 3 0.20460330576630303 0.33831852551664776 (error)
eks wye 4 0.38139939387114097 0.13418874328430463 (error)


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = 4     && false
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  (error)
eks pan 2 0.7586799647899636  0.5221511083334797  (error)
wye wye 3 0.20460330576630303 0.33831852551664776 (error)
eks wye 4 0.38139939387114097 0.13418874328430463 (error)


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = false && %%%panic%%%
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  false
eks pan 2 0.7586799647899636  0.5221511083334797  false
wye wye 3 0.20460330576630303 0.33831852551664776 false
eks wye 4 0.38139939387114097 0.13418874328430463 false


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = true  || true
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  true
eks pan 2 0.7586799647899636  0.5221511083334797  true
wye wye 3 0.20460330576630303 0.33831852551664776 true
eks wye 4 0.38139939387114097 0.13418874328430463 true


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = true  || false
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  true
eks pan 2 0.7586799647899636  0.5221511083334797  true
wye wye 3 0.20460330576630303 0.33831852551664776 true
eks wye 4 0.38139939387114097 0.13418874328430463 true


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = false || true
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  true
eks pan 2 0.7586799647899636  0.5221511083334797  true
wye wye 3 0.20460330576630303 0.33831852551664776 true
eks wye 4 0.38139939387114097 0.13418874328430463 true


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = false || false
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  false
eks pan 2 0.7586799647899636  0.5221511083334797  false
wye wye 3 0.20460330576630303 0.33831852551664776 false
eks wye 4 0.38139939387114097 0.13418874328430463 false


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = true  || 4
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  true
eks pan 2 0.7586799647899636  0.5221511083334797  true
wye wye 3 0.20460330576630303 0.33831852551664776 true
eks wye 4 0.38139939387114097 0.13418874328430463 true


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = false || 4
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  (error)
eks pan 2 0.7586799647899636  0.5221511083334797  (error)
wye wye 3 0.20460330576630303 0.33831852551664776 (error)
eks wye 4 0.38139939387114097 0.13418874328430463 (error)


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = 4     || true
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  (error)
eks pan 2 0.7586799647899636  0.5221511083334797  (error)
wye wye 3 0.20460330576630303 0.33831852551664776 (error)
eks wye 4 0.38139939387114097 0.13418874328430463 (error)


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = 4     || false
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  (error)
eks pan 2 0.7586799647899636  0.5221511083334797  (error)
wye wye 3 0.20460330576630303 0.33831852551664776 (error)
eks wye 4 0.38139939387114097 0.13418874328430463 (error)


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = true  || %%%panic%%%
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  true
eks pan 2 0.7586799647899636  0.5221511083334797  true
wye wye 3 0.20460330576630303 0.33831852551664776 true
eks wye 4 0.38139939387114097 0.13418874328430463 true


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = true  ? 4 : %%%panic%%%
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  4
eks pan 2 0.7586799647899636  0.5221511083334797  4
wye wye 3 0.20460330576630303 0.33831852551664776 4
eks wye 4 0.38139939387114097 0.13418874328430463 4


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = false ? %%%panic%%% : 5
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  5
eks pan 2 0.7586799647899636  0.5221511083334797  5
wye wye 3 0.20460330576630303 0.33831852551664776 5
eks wye 4 0.38139939387114097 0.13418874328430463 5


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = $x ?? %%%panic%%%
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  0.3467901443380824
eks pan 2 0.7586799647899636  0.5221511083334797  0.7586799647899636
wye wye 3 0.20460330576630303 0.33831852551664776 0.20460330576630303
eks wye 4 0.38139939387114097 0.13418874328430463 0.38139939387114097


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = $x ?? 999
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  0.3467901443380824
eks pan 2 0.7586799647899636  0.5221511083334797  0.7586799647899636
wye wye 3 0.20460330576630303 0.33831852551664776 0.20460330576630303
eks wye 4 0.38139939387114097 0.13418874328430463 0.38139939387114097


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = $nonesuch ?? 999
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  999
eks pan 2 0.7586799647899636  0.5221511083334797  999
wye wye 3 0.20460330576630303 0.33831852551664776 999
eks wye 4 0.38139939387114097 0.13418874328430463 999


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $y ??= 999
a   b   i x                   y
pan pan 1 0.3467901443380824  0.7268028627434533
eks pan 2 0.7586799647899636  0.5221511083334797
wye wye 3 0.20460330576630303 0.33831852551664776
eks wye 4 0.38139939387114097 0.13418874328430463


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z ??= 999
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  999
eks pan 2 0.7586799647899636  0.5221511083334797  999
wye wye 3 0.20460330576630303 0.33831852551664776 999
eks wye 4 0.38139939387114097 0.13418874328430463 999


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = "abc\"def\"ghi"
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  abc"def"ghi
eks pan 2 0.7586799647899636  0.5221511083334797  abc"def"ghi
wye wye 3 0.20460330576630303 0.33831852551664776 abc"def"ghi
eks wye 4 0.38139939387114097 0.13418874328430463 abc"def"ghi


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put -v $i += 2
DSL EXPRESSION:
$i += 2
RAW AST:
* statement block
    * assignment "="
        * direct field value "i"
        * operator "+"
            * direct field value "i"
            * int literal "2"

a   b   i x                   y
pan pan 3 0.3467901443380824  0.7268028627434533
eks pan 4 0.7586799647899636  0.5221511083334797
wye wye 5 0.20460330576630303 0.33831852551664776
eks wye 6 0.38139939387114097 0.13418874328430463


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put -v $i *= 2
DSL EXPRESSION:
$i *= 2
RAW AST:
* statement block
    * assignment "="
        * direct field value "i"
        * operator "*"
            * direct field value "i"
            * int literal "2"

a   b   i x                   y
pan pan 2 0.3467901443380824  0.7268028627434533
eks pan 4 0.7586799647899636  0.5221511083334797
wye wye 6 0.20460330576630303 0.33831852551664776
eks wye 8 0.38139939387114097 0.13418874328430463


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put -v $i /= 2
DSL EXPRESSION:
$i /= 2
RAW AST:
* statement block
    * assignment "="
        * direct field value "i"
        * operator "/"
            * direct field value "i"
            * int literal "2"

a   b   i   x                   y
pan pan 0.5 0.3467901443380824  0.7268028627434533
eks pan 1   0.7586799647899636  0.5221511083334797
wye wye 1.5 0.20460330576630303 0.33831852551664776
eks wye 2   0.38139939387114097 0.13418874328430463


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put -v $i |= 2
DSL EXPRESSION:
$i |= 2
RAW AST:
* statement block
    * assignment "="
        * direct field value "i"
        * operator "|"
            * direct field value "i"
            * int literal "2"

a   b   i x                   y
pan pan 3 0.3467901443380824  0.7268028627434533
eks pan 2 0.7586799647899636  0.5221511083334797
wye wye 3 0.20460330576630303 0.33831852551664776
eks wye 6 0.38139939387114097 0.13418874328430463


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put -v $j = true; $j &&= $i < 2
DSL EXPRESSION:
$j = true; $j &&= $i < 2
RAW AST:
* statement block
    * assignment "="
        * direct field value "j"
        * bool literal "true"
    * assignment "="
        * direct field value "j"
        * operator "&&"
            * direct field value "j"
            * operator "<"
                * direct field value "i"
                * int literal "2"

a   b   i x                   y                   j
pan pan 1 0.3467901443380824  0.7268028627434533  true
eks pan 2 0.7586799647899636  0.5221511083334797  false
wye wye 3 0.20460330576630303 0.33831852551664776 false
eks wye 4 0.38139939387114097 0.13418874328430463 false


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = [$a,$b,$i,$x,$y][1]
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  pan
eks pan 2 0.7586799647899636  0.5221511083334797  eks
wye wye 3 0.20460330576630303 0.33831852551664776 wye
eks wye 4 0.38139939387114097 0.13418874328430463 eks


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = [$a,$b,$i,$x,$y][-1]
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  0.7268028627434533
eks pan 2 0.7586799647899636  0.5221511083334797  0.5221511083334797
wye wye 3 0.20460330576630303 0.33831852551664776 0.33831852551664776
eks wye 4 0.38139939387114097 0.13418874328430463 0.13418874328430463


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = [$a,$b,$i,$x,$y][NR]
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  pan
eks pan 2 0.7586799647899636  0.5221511083334797  pan
wye wye 3 0.20460330576630303 0.33831852551664776 3
eks wye 4 0.38139939387114097 0.13418874328430463 0.38139939387114097


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put $z = {"a":$a,"b":$b,"i":$i,"x":$x,"y":$y}["b"]
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  pan
eks pan 2 0.7586799647899636  0.5221511083334797  pan
wye wye 3 0.20460330576630303 0.33831852551664776 wye
eks wye 4 0.38139939387114097 0.13418874328430463 wye


----------------------------------------------------------------
mlr --from u/s.dkvp --from u/t.dkvp --ojson put $z=[1,2,[NR,[FILENAME,5],$x*$y]]
{
  "a": "pan",
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533,
  "z": [
    1,
    2,
    [
      1,
      ["u/s.dkvp", 5],
      0.2520480696761337
    ]
  ]
}
{
  "a": "eks",
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797,
  "z": [
    1,
    2,
    [
      2,
      ["u/s.dkvp", 5],
      0.3961455844854848
    ]
  ]
}
{
  "a": "wye",
  "b": "wye",
  "i": 3,
  "x": 0.20460330576630303,
  "y": 0.33831852551664776,
  "z": [
    1,
    2,
    [
      3,
      ["u/s.dkvp", 5],
      0.06922108872268748
    ]
  ]
}
{
  "a": "eks",
  "b": "wye",
  "i": 4,
  "x": 0.38139939387114097,
  "y": 0.13418874328430463,
  "z": [
    1,
    2,
    [
      4,
      ["u/s.dkvp", 5],
      0.05117950535296393
    ]
  ]
}
{
  "a": "wye",
  "b": "pan",
  "i": 5,
  "x": 0.5732889198020006,
  "y": 0.8636244699032729,
  "z": [
    1,
    2,
    [
      5,
      ["u/t.dkvp", 5],
      0.4951063394654227
    ]
  ]
}
{
  "a": "zee",
  "b": "pan",
  "i": 6,
  "x": 0.5271261600918548,
  "y": 0.49322128674835697,
  "z": [
    1,
    2,
    [
      6,
      ["u/t.dkvp", 5],
      0.259989842959225
    ]
  ]
}
{
  "a": "eks",
  "b": "zee",
  "i": 7,
  "x": 0.6117840605678454,
  "y": 0.1878849191181694,
  "z": [
    1,
    2,
    [
      7,
      ["u/t.dkvp", 5],
      0.11494499873757488
    ]
  ]
}

----------------------------------------------------------------
mlr --json cat
{
  "x": 1
}

----------------------------------------------------------------
mlr --json cat
{
  "x": [1, 2, 3]
}

----------------------------------------------------------------
mlr --json cat
{
  "x": [
    1,
    [2, 3, 4],
    5
  ]
}

----------------------------------------------------------------
mlr --json cat
{
  "x": [
    1,
    [
      2,
      [3, 4, 5],
      6
    ],
    7
  ]
}

----------------------------------------------------------------
mlr --json cat
{
  "x": {}
}

----------------------------------------------------------------
mlr --json cat
{
  "x": {
    "a": 1,
    "b": 2,
    "c": 3
  }
}

----------------------------------------------------------------
mlr --json cat
{
  "x": {
    "a": 1,
    "b": {
      "c": 3,
      "d": 4,
      "e": 5
    },
    "f": 6
  }
}

----------------------------------------------------------------
mlr --json cat
{
  "x": {},
  "y": 1
}

----------------------------------------------------------------
mlr --json cat
{
  "x": {
    "a": 1,
    "b": 2,
    "c": 3
  },
  "y": 4
}

----------------------------------------------------------------
mlr --json cat
{
  "x": {
    "a": 1,
    "b": {
      "c": 3,
      "d": 4,
      "e": 5
    },
    "f": 6
  },
  "y": 7
}
{
  "x": 1
}
{
  "x": [1, 2, 3]
}
{
  "x": [
    1,
    [2, 3, 4],
    5
  ]
}
{
  "x": [
    1,
    [
      2,
      [3, 4, 5],
      6
    ],
    7
  ]
}
{
  "x": {}
}
{
  "x": {
    "a": 1,
    "b": 2,
    "c": 3
  }
}
{
  "x": {
    "a": 1,
    "b": {
      "c": 3,
      "d": 4,
      "e": 5
    },
    "f": 6
  }
}
{
  "x": {},
  "y": 1
}
{
  "x": {
    "a": 1,
    "b": 2,
    "c": 3
  },
  "y": 4
}
{
  "x": {
    "a": 1,
    "b": {
      "c": 3,
      "d": 4,
      "e": 5
    },
    "f": 6
  },
  "y": 7
}


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --ojson put $z = $*["a"]
{
  "a": "pan",
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533,
  "z": "pan"
}
{
  "a": "eks",
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797,
  "z": "eks"
}
{
  "a": "wye",
  "b": "wye",
  "i": 3,
  "x": 0.20460330576630303,
  "y": 0.33831852551664776,
  "z": "wye"
}
{
  "a": "eks",
  "b": "wye",
  "i": 4,
  "x": 0.38139939387114097,
  "y": 0.13418874328430463,
  "z": "eks"
}


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --ojson put $z = $*
{
  "a": "pan",
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533,
  "z": {
    "a": "pan",
    "b": "pan",
    "i": 1,
    "x": 0.3467901443380824,
    "y": 0.7268028627434533
  }
}
{
  "a": "eks",
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797,
  "z": {
    "a": "eks",
    "b": "pan",
    "i": 2,
    "x": 0.7586799647899636,
    "y": 0.5221511083334797
  }
}
{
  "a": "wye",
  "b": "wye",
  "i": 3,
  "x": 0.20460330576630303,
  "y": 0.33831852551664776,
  "z": {
    "a": "wye",
    "b": "wye",
    "i": 3,
    "x": 0.20460330576630303,
    "y": 0.33831852551664776
  }
}
{
  "a": "eks",
  "b": "wye",
  "i": 4,
  "x": 0.38139939387114097,
  "y": 0.13418874328430463,
  "z": {
    "a": "eks",
    "b": "wye",
    "i": 4,
    "x": 0.38139939387114097,
    "y": 0.13418874328430463
  }
}


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --ojson put $* = {"s": 7, "t": 8}
{
  "s": 7,
  "t": 8
}
{
  "s": 7,
  "t": 8
}
{
  "s": 7,
  "t": 8
}
{
  "s": 7,
  "t": 8
}


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --ojson put $*["st"] = 78
{
  "a": "pan",
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533,
  "st": 78
}
{
  "a": "eks",
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797,
  "st": 78
}
{
  "a": "wye",
  "b": "wye",
  "i": 3,
  "x": 0.20460330576630303,
  "y": 0.33831852551664776,
  "st": 78
}
{
  "a": "eks",
  "b": "wye",
  "i": 4,
  "x": 0.38139939387114097,
  "y": 0.13418874328430463,
  "st": 78
}


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --ojson put $*["a"] = 78
{
  "a": 78,
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533
}
{
  "a": 78,
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797
}
{
  "a": 78,
  "b": "wye",
  "i": 3,
  "x": 0.20460330576630303,
  "y": 0.33831852551664776
}
{
  "a": 78,
  "b": "wye",
  "i": 4,
  "x": 0.38139939387114097,
  "y": 0.13418874328430463
}


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --ojson put $*["a"] = {}
{
  "a": {},
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533
}
{
  "a": {},
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797
}
{
  "a": {},
  "b": "wye",
  "i": 3,
  "x": 0.20460330576630303,
  "y": 0.33831852551664776
}
{
  "a": {},
  "b": "wye",
  "i": 4,
  "x": 0.38139939387114097,
  "y": 0.13418874328430463
}


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put -v $new = $["a"]
DSL EXPRESSION:
$new = $["a"]
RAW AST:
* statement block
    * assignment "="
        * direct field value "new"
        * indirect field value "$[]"
            * string literal "a"

a   b   i x                   y                   new
pan pan 1 0.3467901443380824  0.7268028627434533  pan
eks pan 2 0.7586799647899636  0.5221511083334797  eks
wye wye 3 0.20460330576630303 0.33831852551664776 wye
eks wye 4 0.38139939387114097 0.13418874328430463 eks


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put -v $["new"] = $a
DSL EXPRESSION:
$["new"] = $a
RAW AST:
* statement block
    * assignment "="
        * indirect field value "$[]"
            * string literal "new"
        * direct field value "a"

a   b   i x                   y                   new
pan pan 1 0.3467901443380824  0.7268028627434533  pan
eks pan 2 0.7586799647899636  0.5221511083334797  eks
wye wye 3 0.20460330576630303 0.33831852551664776 wye
eks wye 4 0.38139939387114097 0.13418874328430463 eks


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put -v ${new} = $a . $b
DSL EXPRESSION:
${new} = $a . $b
RAW AST:
* statement block
    * assignment "="
        * direct field value "new"
        * operator "."
            * direct field value "a"
            * direct field value "b"

a   b   i x                   y                   new
pan pan 1 0.3467901443380824  0.7268028627434533  panpan
eks pan 2 0.7586799647899636  0.5221511083334797  ekspan
wye wye 3 0.20460330576630303 0.33831852551664776 wyewye
eks wye 4 0.38139939387114097 0.13418874328430463 ekswye


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put -v $new = ${a} . ${b}
DSL EXPRESSION:
$new = ${a} . ${b}
RAW AST:
* statement block
    * assignment "="
        * direct field value "new"
        * operator "."
            * direct field value "a"
            * direct field value "b"

a   b   i x                   y                   new
pan pan 1 0.3467901443380824  0.7268028627434533  panpan
eks pan 2 0.7586799647899636  0.5221511083334797  ekspan
wye wye 3 0.20460330576630303 0.33831852551664776 wyewye
eks wye 4 0.38139939387114097 0.13418874328430463 ekswye


----------------------------------------------------------------
mlr --from u/s.dkvp --idkvp --opprint put @tmp = $a . $b; $ab = @tmp
a   b   i x                   y                   ab
pan pan 1 0.3467901443380824  0.7268028627434533  panpan
eks pan 2 0.7586799647899636  0.5221511083334797  ekspan
wye wye 3 0.20460330576630303 0.33831852551664776 wyewye
eks wye 4 0.38139939387114097 0.13418874328430463 ekswye


----------------------------------------------------------------
mlr --ojson --from u/s.dkvp put @curi=$i; $curi = @curi; $lagi=@lagi; @lagi=$i
{
  "a": "pan",
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533,
  "curi": 1
}
{
  "a": "eks",
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797,
  "curi": 2,
  "lagi": 1
}
{
  "a": "wye",
  "b": "wye",
  "i": 3,
  "x": 0.20460330576630303,
  "y": 0.33831852551664776,
  "curi": 3,
  "lagi": 2
}
{
  "a": "eks",
  "b": "wye",
  "i": 4,
  "x": 0.38139939387114097,
  "y": 0.13418874328430463,
  "curi": 4,
  "lagi": 3
}


----------------------------------------------------------------
mlr --from u/s.dkvp --ojson put $z["abc"]["def"]["ghi"]=NR
{
  "a": "pan",
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533,
  "z": {
    "abc": {
      "def": {
        "ghi": 1
      }
    }
  }
}
{
  "a": "eks",
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797,
  "z": {
    "abc": {
      "def": {
        "ghi": 2
      }
    }
  }
}
{
  "a": "wye",
  "b": "wye",
  "i": 3,
  "x": 0.20460330576630303,
  "y": 0.33831852551664776,
  "z": {
    "abc": {
      "def": {
        "ghi": 3
      }
    }
  }
}
{
  "a": "eks",
  "b": "wye",
  "i": 4,
  "x": 0.38139939387114097,
  "y": 0.13418874328430463,
  "z": {
    "abc": {
      "def": {
        "ghi": 4
      }
    }
  }
}


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp --from u/t.dkvp put $up   = $[NR]
a   b   i x                   y                   up
pan pan 1 0.3467901443380824  0.7268028627434533  pan
eks pan 2 0.7586799647899636  0.5221511083334797  pan
wye wye 3 0.20460330576630303 0.33831852551664776 3
eks wye 4 0.38139939387114097 0.13418874328430463 0.38139939387114097
wye pan 5 0.5732889198020006  0.8636244699032729  0.8636244699032729

a   b   i x                  y
zee pan 6 0.5271261600918548 0.49322128674835697
eks zee 7 0.6117840605678454 0.1878849191181694


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp --from u/t.dkvp put $down = $[-NR]
a   b   i x                   y                   down
pan pan 1 0.3467901443380824  0.7268028627434533  0.7268028627434533
eks pan 2 0.7586799647899636  0.5221511083334797  0.7586799647899636
wye wye 3 0.20460330576630303 0.33831852551664776 3
eks wye 4 0.38139939387114097 0.13418874328430463 wye
wye pan 5 0.5732889198020006  0.8636244699032729  wye

a   b   i x                  y
zee pan 6 0.5271261600918548 0.49322128674835697
eks zee 7 0.6117840605678454 0.1878849191181694


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp --from u/t.dkvp put $up   = $*[NR]
a   b   i x                   y                   up
pan pan 1 0.3467901443380824  0.7268028627434533  pan
eks pan 2 0.7586799647899636  0.5221511083334797  pan
wye wye 3 0.20460330576630303 0.33831852551664776 3
eks wye 4 0.38139939387114097 0.13418874328430463 0.38139939387114097
wye pan 5 0.5732889198020006  0.8636244699032729  0.8636244699032729

a   b   i x                  y
zee pan 6 0.5271261600918548 0.49322128674835697
eks zee 7 0.6117840605678454 0.1878849191181694


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp --from u/t.dkvp put $down = $*[-NR]
a   b   i x                   y                   down
pan pan 1 0.3467901443380824  0.7268028627434533  0.7268028627434533
eks pan 2 0.7586799647899636  0.5221511083334797  0.7586799647899636
wye wye 3 0.20460330576630303 0.33831852551664776 3
eks wye 4 0.38139939387114097 0.13418874328430463 wye
wye pan 5 0.5732889198020006  0.8636244699032729  wye

a   b   i x                  y
zee pan 6 0.5271261600918548 0.49322128674835697
eks zee 7 0.6117840605678454 0.1878849191181694


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp --from u/t.dkvp put $[1] = "new"
a   b   i x                   y
new pan 1 0.3467901443380824  0.7268028627434533
new pan 2 0.7586799647899636  0.5221511083334797
new wye 3 0.20460330576630303 0.33831852551664776
new wye 4 0.38139939387114097 0.13418874328430463
new pan 5 0.5732889198020006  0.8636244699032729
new pan 6 0.5271261600918548  0.49322128674835697
new zee 7 0.6117840605678454  0.1878849191181694


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp --from u/t.dkvp put $[2] = "new"
a   b   i x                   y
pan new 1 0.3467901443380824  0.7268028627434533
eks new 2 0.7586799647899636  0.5221511083334797
wye new 3 0.20460330576630303 0.33831852551664776
eks new 4 0.38139939387114097 0.13418874328430463
wye new 5 0.5732889198020006  0.8636244699032729
zee new 6 0.5271261600918548  0.49322128674835697
eks new 7 0.6117840605678454  0.1878849191181694


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp --from u/t.dkvp put $[5] = "new"
a   b   i x                   y
pan pan 1 0.3467901443380824  new
eks pan 2 0.7586799647899636  new
wye wye 3 0.20460330576630303 new
eks wye 4 0.38139939387114097 new
wye pan 5 0.5732889198020006  new
zee pan 6 0.5271261600918548  new
eks zee 7 0.6117840605678454  new


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp --from u/t.dkvp put $[-1] = "new"
a   b   i x                   y
pan pan 1 0.3467901443380824  new
eks pan 2 0.7586799647899636  new
wye wye 3 0.20460330576630303 new
eks wye 4 0.38139939387114097 new
wye pan 5 0.5732889198020006  new
zee pan 6 0.5271261600918548  new
eks zee 7 0.6117840605678454  new


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp --from u/t.dkvp put $[-2] = "new"
a   b   i x   y
pan pan 1 new 0.7268028627434533
eks pan 2 new 0.5221511083334797
wye wye 3 new 0.33831852551664776
eks wye 4 new 0.13418874328430463
wye pan 5 new 0.8636244699032729
zee pan 6 new 0.49322128674835697
eks zee 7 new 0.1878849191181694


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp --from u/t.dkvp put $[-5] = "new"
a   b   i x                   y
new pan 1 0.3467901443380824  0.7268028627434533
new pan 2 0.7586799647899636  0.5221511083334797
new wye 3 0.20460330576630303 0.33831852551664776
new wye 4 0.38139939387114097 0.13418874328430463
new pan 5 0.5732889198020006  0.8636244699032729
new pan 6 0.5271261600918548  0.49322128674835697
new zee 7 0.6117840605678454  0.1878849191181694


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp --from u/t.dkvp put @idx = NR % 5; @idx = @idx == 0 ? 5 : @idx; $[@idx] = "NEW"
a   b   i   x                   y
NEW pan 1   0.3467901443380824  0.7268028627434533
eks NEW 2   0.7586799647899636  0.5221511083334797
wye wye NEW 0.20460330576630303 0.33831852551664776
eks wye 4   NEW                 0.13418874328430463
wye pan 5   0.5732889198020006  NEW
NEW pan 6   0.5271261600918548  0.49322128674835697
eks NEW 7   0.6117840605678454  0.1878849191181694


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp --from u/t.dkvp put $*[1] = "new"
a   b   i x                   y
new pan 1 0.3467901443380824  0.7268028627434533
new pan 2 0.7586799647899636  0.5221511083334797
new wye 3 0.20460330576630303 0.33831852551664776
new wye 4 0.38139939387114097 0.13418874328430463
new pan 5 0.5732889198020006  0.8636244699032729
new pan 6 0.5271261600918548  0.49322128674835697
new zee 7 0.6117840605678454  0.1878849191181694


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp --from u/t.dkvp put $*[2] = "new"
a   b   i x                   y
pan new 1 0.3467901443380824  0.7268028627434533
eks new 2 0.7586799647899636  0.5221511083334797
wye new 3 0.20460330576630303 0.33831852551664776
eks new 4 0.38139939387114097 0.13418874328430463
wye new 5 0.5732889198020006  0.8636244699032729
zee new 6 0.5271261600918548  0.49322128674835697
eks new 7 0.6117840605678454  0.1878849191181694


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp --from u/t.dkvp put $*[5] = "new"
a   b   i x                   y
pan pan 1 0.3467901443380824  new
eks pan 2 0.7586799647899636  new
wye wye 3 0.20460330576630303 new
eks wye 4 0.38139939387114097 new
wye pan 5 0.5732889198020006  new
zee pan 6 0.5271261600918548  new
eks zee 7 0.6117840605678454  new


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp --from u/t.dkvp put $*[-1] = "new"
a   b   i x                   y
pan pan 1 0.3467901443380824  new
eks pan 2 0.7586799647899636  new
wye wye 3 0.20460330576630303 new
eks wye 4 0.38139939387114097 new
wye pan 5 0.5732889198020006  new
zee pan 6 0.5271261600918548  new
eks zee 7 0.6117840605678454  new


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp --from u/t.dkvp put $*[-2] = "new"
a   b   i x   y
pan pan 1 new 0.7268028627434533
eks pan 2 new 0.5221511083334797
wye wye 3 new 0.33831852551664776
eks wye 4 new 0.13418874328430463
wye pan 5 new 0.8636244699032729
zee pan 6 new 0.49322128674835697
eks zee 7 new 0.1878849191181694


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp --from u/t.dkvp put $*[-5] = "new"
a   b   i x                   y
new pan 1 0.3467901443380824  0.7268028627434533
new pan 2 0.7586799647899636  0.5221511083334797
new wye 3 0.20460330576630303 0.33831852551664776
new wye 4 0.38139939387114097 0.13418874328430463
new pan 5 0.5732889198020006  0.8636244699032729
new pan 6 0.5271261600918548  0.49322128674835697
new zee 7 0.6117840605678454  0.1878849191181694


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp --from u/t.dkvp put @idx = NR % 5; @idx = @idx == 0 ? 5 : @idx; $*[@idx] = "NEW"
a   b   i   x                   y
NEW pan 1   0.3467901443380824  0.7268028627434533
eks NEW 2   0.7586799647899636  0.5221511083334797
wye wye NEW 0.20460330576630303 0.33831852551664776
eks wye 4   NEW                 0.13418874328430463
wye pan 5   0.5732889198020006  NEW
NEW pan 6   0.5271261600918548  0.49322128674835697
eks NEW 7   0.6117840605678454  0.1878849191181694


----------------------------------------------------------------
mlr --json put $a=$a[2]["b"][1] u/nested.json
{
  "a": (error),
  "b": "c"
}


----------------------------------------------------------------
mlr --ojson --from u/2.dkvp put $abc[FILENAME] = "def"
{
  "a": "pan",
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533,
  "abc": {
    "u/2.dkvp": "def"
  }
}
{
  "a": "eks",
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797,
  "abc": {
    "u/2.dkvp": "def"
  }
}


----------------------------------------------------------------
mlr --ojson --from u/2.dkvp put $abc[NR] = "def"
{
  "a": "pan",
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533,
  "abc": ["def"]
}
{
  "a": "eks",
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797,
  "abc": ["", "def"]
}


----------------------------------------------------------------
mlr --ojson --from u/2.dkvp put $abc[FILENAME][NR] = "def"
{
  "a": "pan",
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533,
  "abc": {
    "u/2.dkvp": ["def"]
  }
}
{
  "a": "eks",
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797,
  "abc": {
    "u/2.dkvp": ["", "def"]
  }
}


----------------------------------------------------------------
mlr --ojson --from u/2.dkvp put $abc[NR][FILENAME] = "def"
{
  "a": "pan",
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533,
  "abc": [
    {
      "u/2.dkvp": "def"
    }
  ]
}
{
  "a": "eks",
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797,
  "abc": [
    "",
    {
      "u/2.dkvp": "def"
    }
  ]
}


----------------------------------------------------------------
mlr --ojson --from u/2.dkvp put @abc[FILENAME] = "def"; $ghi = @abc
{
  "a": "pan",
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533,
  "ghi": {
    "u/2.dkvp": "def"
  }
}
{
  "a": "eks",
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797,
  "ghi": {
    "u/2.dkvp": "def"
  }
}


----------------------------------------------------------------
mlr --ojson --from u/2.dkvp put @abc[NR] = "def"; $ghi = @abc
{
  "a": "pan",
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533,
  "ghi": ["def"]
}
{
  "a": "eks",
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797,
  "ghi": ["def", "def"]
}


----------------------------------------------------------------
mlr --ojson --from u/2.dkvp put @abc[FILENAME][NR] = "def"; $ghi = @abc
{
  "a": "pan",
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533,
  "ghi": {
    "u/2.dkvp": ["def"]
  }
}
{
  "a": "eks",
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797,
  "ghi": {
    "u/2.dkvp": ["def", "def"]
  }
}


----------------------------------------------------------------
mlr --ojson --from u/2.dkvp put @abc[NR][FILENAME] = "def"; $ghi = @abc
{
  "a": "pan",
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533,
  "ghi": [
    {
      "u/2.dkvp": "def"
    }
  ]
}
{
  "a": "eks",
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797,
  "ghi": [
    {
      "u/2.dkvp": "def"
    },
    {
      "u/2.dkvp": "def"
    }
  ]
}


----------------------------------------------------------------
mlr --from u/2.dkvp --ojson put @a = 3; $new=@a
{
  "a": "pan",
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533,
  "new": 3
}
{
  "a": "eks",
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797,
  "new": 3
}


----------------------------------------------------------------
mlr --from u/2.dkvp --ojson put @a = 3; @a[1]=4; $new=@a
{
  "a": "pan",
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533,
  "new": [4]
}
{
  "a": "eks",
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797,
  "new": [4]
}


----------------------------------------------------------------
mlr --from u/2.dkvp --ojson put @a = 3; @a[1]=4;@a[1][1]=5; $new=@a
{
  "a": "pan",
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533,
  "new": [
    [5]
  ]
}
{
  "a": "eks",
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797,
  "new": [
    [5]
  ]
}


----------------------------------------------------------------
mlr --from u/2.dkvp --ojson put @a = 3; @a["x"]=4; $new=@a
{
  "a": "pan",
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533,
  "new": {
    "x": 4
  }
}
{
  "a": "eks",
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797,
  "new": {
    "x": 4
  }
}


----------------------------------------------------------------
mlr --from u/2.dkvp --ojson put @a = 3; @a["x"]=4;@a["x"]["x"]=5; $new=@a
{
  "a": "pan",
  "b": "pan",
  "i": 1,
  "x": 0.3467901443380824,
  "y": 0.7268028627434533,
  "new": {
    "x": {
      "x": 5
    }
  }
}
{
  "a": "eks",
  "b": "pan",
  "i": 2,
  "x": 0.7586799647899636,
  "y": 0.5221511083334797,
  "new": {
    "x": {
      "x": 5
    }
  }
}


----------------------------------------------------------------
mlr -n put -v $z=max()
DSL EXPRESSION:
$z=max()
RAW AST:
* statement block
    * assignment "="
        * direct field value "z"
        * function callsite "max"



----------------------------------------------------------------
mlr -n put -v $z=max(1)
DSL EXPRESSION:
$z=max(1)
RAW AST:
* statement block
    * assignment "="
        * direct field value "z"
        * function callsite "max"
            * int literal "1"



----------------------------------------------------------------
mlr -n put -v $z=max(1,)
DSL EXPRESSION:
$z=max(1,)
RAW AST:
* statement block
    * assignment "="
        * direct field value "z"
        * function callsite "max"
            * int literal "1"



----------------------------------------------------------------
mlr -n put -v $z=max(1,2)
DSL EXPRESSION:
$z=max(1,2)
RAW AST:
* statement block
    * assignment "="
        * direct field value "z"
        * function callsite "max"
            * int literal "1"
            * int literal "2"



----------------------------------------------------------------
mlr -n put -v $z=max(1,2,)
DSL EXPRESSION:
$z=max(1,2,)
RAW AST:
* statement block
    * assignment "="
        * direct field value "z"
        * function callsite "max"
            * int literal "1"
            * int literal "2"



----------------------------------------------------------------
mlr -n put -v $z=max(1,2,3)
DSL EXPRESSION:
$z=max(1,2,3)
RAW AST:
* statement block
    * assignment "="
        * direct field value "z"
        * function callsite "max"
            * int literal "1"
            * int literal "2"
            * int literal "3"



----------------------------------------------------------------
mlr -n put -v $z=max(1,2,3,)
DSL EXPRESSION:
$z=max(1,2,3,)
RAW AST:
* statement block
    * assignment "="
        * direct field value "z"
        * function callsite "max"
            * int literal "1"
            * int literal "2"
            * int literal "3"



----------------------------------------------------------------
mlr --from u/s.dkvp --opprint put $z = max($x,$y)
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  0.7268028627434533
eks pan 2 0.7586799647899636  0.5221511083334797  0.7586799647899636
wye wye 3 0.20460330576630303 0.33831852551664776 0.33831852551664776
eks wye 4 0.38139939387114097 0.13418874328430463 0.38139939387114097


----------------------------------------------------------------
mlr --from u/s.dkvp --opprint put $z = min($x,$y,$i)
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  0
eks pan 2 0.7586799647899636  0.5221511083334797  0
wye wye 3 0.20460330576630303 0.33831852551664776 0
eks wye 4 0.38139939387114097 0.13418874328430463 0


----------------------------------------------------------------
mlr --from u/s.dkvp --opprint put $z = abs($x)
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  0.3467901443380824
eks pan 2 0.7586799647899636  0.5221511083334797  0.7586799647899636
wye wye 3 0.20460330576630303 0.33831852551664776 0.20460330576630303
eks wye 4 0.38139939387114097 0.13418874328430463 0.38139939387114097


----------------------------------------------------------------
mlr --from u/s.dkvp --opprint put $c = cos(2*M_PI*NR/32); $s = sin(2*M_PI*NR/32)
a   b   i x                   y                   c                  s
pan pan 1 0.3467901443380824  0.7268028627434533  0.9807852804032304 0.19509032201612825
eks pan 2 0.7586799647899636  0.5221511083334797  0.9238795325112867 0.3826834323650898
wye wye 3 0.20460330576630303 0.33831852551664776 0.8314696123025453 0.5555702330196022
eks wye 4 0.38139939387114097 0.13418874328430463 0.7071067811865476 0.7071067811865475


----------------------------------------------------------------
mlr --from u/s.dkvp --opprint put filter NR > 2
a   b   i x                   y
wye wye 3 0.20460330576630303 0.33831852551664776
eks wye 4 0.38139939387114097 0.13418874328430463


----------------------------------------------------------------
mlr --from u/s.dkvp --opprint put -q @sum[$a] += $i; emit {"sum": @sum}
sum
{
  "pan": 1
}
{
  "pan": 1,
  "eks": 2
}
{
  "pan": 1,
  "eks": 2,
  "wye": 3
}
{
  "pan": 1,
  "eks": 6,
  "wye": 3
}


----------------------------------------------------------------
mlr --from u/s.dkvp put -q @sum += $x; dump
{
  "sum": 0.3467901443380824
}
{
  "sum": 1.105470109128046
}
{
  "sum": 1.3100734148943491
}
{
  "sum": 1.6914728087654902
}


----------------------------------------------------------------
mlr --from u/s.dkvp put -q @sum[$a] += $x; dump
{
  "sum": {
    "pan": 0.3467901443380824
  }
}
{
  "sum": {
    "pan": 0.3467901443380824,
    "eks": 0.7586799647899636
  }
}
{
  "sum": {
    "pan": 0.3467901443380824,
    "eks": 0.7586799647899636,
    "wye": 0.20460330576630303
  }
}
{
  "sum": {
    "pan": 0.3467901443380824,
    "eks": 1.1400793586611044,
    "wye": 0.20460330576630303
  }
}


----------------------------------------------------------------
mlr --from u/s.dkvp put -q begin{@sum=0} @sum += $x; end{dump}
{
  "sum": 1.6914728087654902
}


----------------------------------------------------------------
mlr --from u/s.dkvp put -q begin{@sum={}} @sum[$a] += $x; end{dump}
{
  "sum": {
    "pan": 0.3467901443380824,
    "eks": 1.1400793586611044,
    "wye": 0.20460330576630303
  }
}


----------------------------------------------------------------
mlr --from u/s.dkvp put if (NR == 1) { $z = 100 }
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533,z=100
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463


----------------------------------------------------------------
mlr --from u/s.dkvp put if (NR == 1) { $z = 100 } else { $z = 900 }
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533,z=100
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797,z=900
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776,z=900
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463,z=900


----------------------------------------------------------------
mlr --from u/s.dkvp put if (NR == 1) { $z = 100 } elif (NR == 2) { $z = 200 }
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533,z=100
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797,z=200
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463


----------------------------------------------------------------
mlr --from u/s.dkvp put if (NR == 1) { $z = 100 } elif (NR == 2) { $z = 200 } else { $z = 900 }
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533,z=100
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797,z=200
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776,z=900
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463,z=900


----------------------------------------------------------------
mlr --from u/s.dkvp put if (NR == 1) { $z = 100 } elif (NR == 2) { $z = 200 } elif (NR == 3) { $z = 300 } else { $z = 900 }
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533,z=100
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797,z=200
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776,z=300
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463,z=900


----------------------------------------------------------------
mlr --from u/s.dkvp put NR == 2 { $z = 100 }
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797,z=100
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463


----------------------------------------------------------------
mlr --from u/s.dkvp put NR != 2 { $z = 100 }
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533,z=100
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776,z=100
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463,z=100

----------------------------------------------------------------
mlr put $y=ssub($x, "e", "X")
x=eeee,y=Xeee

----------------------------------------------------------------
mlr put $y=gsub($x, "e", "X")
x=eeee,y=XXXX


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp put $z = truncate($a, -1)
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  (error)
eks pan 2 0.7586799647899636  0.5221511083334797  (error)
wye wye 3 0.20460330576630303 0.33831852551664776 (error)
eks wye 4 0.38139939387114097 0.13418874328430463 (error)


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp put $z = truncate($a, 0)
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  -
eks pan 2 0.7586799647899636  0.5221511083334797  -
wye wye 3 0.20460330576630303 0.33831852551664776 -
eks wye 4 0.38139939387114097 0.13418874328430463 -


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp put $z = truncate($a, 1)
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  p
eks pan 2 0.7586799647899636  0.5221511083334797  e
wye wye 3 0.20460330576630303 0.33831852551664776 w
eks wye 4 0.38139939387114097 0.13418874328430463 e


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp put $z = truncate($a, 2)
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  pa
eks pan 2 0.7586799647899636  0.5221511083334797  ek
wye wye 3 0.20460330576630303 0.33831852551664776 wy
eks wye 4 0.38139939387114097 0.13418874328430463 ek


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp put $z = truncate($a, 3)
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  pan
eks pan 2 0.7586799647899636  0.5221511083334797  eks
wye wye 3 0.20460330576630303 0.33831852551664776 wye
eks wye 4 0.38139939387114097 0.13418874328430463 eks


----------------------------------------------------------------
mlr --opprint --from u/s.dkvp put $z = truncate($a, 4)
a   b   i x                   y                   z
pan pan 1 0.3467901443380824  0.7268028627434533  pan
eks pan 2 0.7586799647899636  0.5221511083334797  eks
wye wye 3 0.20460330576630303 0.33831852551664776 wye
eks wye 4 0.38139939387114097 0.13418874328430463 eks


----------------------------------------------------------------
mlr --from u/s.dkvp head -n 2 then put -q for (k in $*) { emit { "foo" : "bar" } }
foo=bar
foo=bar
foo=bar
foo=bar
foo=bar
foo=bar
foo=bar
foo=bar
foo=bar
foo=bar


----------------------------------------------------------------
mlr --from u/s.dkvp head -n 2 then put -q for (k in $*) { emit { "foo" : k } }
foo=a
foo=b
foo=i
foo=x
foo=y
foo=a
foo=b
foo=i
foo=x
foo=y


----------------------------------------------------------------
mlr --from u/s.dkvp head -n 2 then put -q for (k in $*) { emit { k: "bar" } }
a=bar
b=bar
i=bar
x=bar
y=bar
a=bar
b=bar
i=bar
x=bar
y=bar


----------------------------------------------------------------
mlr --from u/s.dkvp head -n 2 then put -q for (k in $*) { emit { k : k } }
a=a
b=b
i=i
x=x
y=y
a=a
b=b
i=i
x=x
y=y


----------------------------------------------------------------
mlr --from u/s.dkvp head -n 2 then put -q for (k,v in $*) { emit { "foo" : "bar" } }
foo=bar
foo=bar
foo=bar
foo=bar
foo=bar
foo=bar
foo=bar
foo=bar
foo=bar
foo=bar


----------------------------------------------------------------
mlr --from u/s.dkvp head -n 2 then put -q for (k,v in $*) { emit { "foo" : v } }
foo=pan
foo=pan
foo=1
foo=0.3467901443380824
foo=0.7268028627434533
foo=eks
foo=pan
foo=2
foo=0.7586799647899636
foo=0.5221511083334797


----------------------------------------------------------------
mlr --from u/s.dkvp head -n 2 then put -q for (k,v in $*) { emit { k: "bar" } }
a=bar
b=bar
i=bar
x=bar
y=bar
a=bar
b=bar
i=bar
x=bar
y=bar


----------------------------------------------------------------
mlr --from u/s.dkvp head -n 2 then put -q for (k,v in $*) { emit { k : v } }
a=pan
b=pan
i=1
x=0.3467901443380824
y=0.7268028627434533
a=eks
b=pan
i=2
x=0.7586799647899636
y=0.5221511083334797


----------------------------------------------------------------
mlr --from u/s.dkvp put $z = 0; while ($z < $i) {$z += 1}
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533,z=1
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797,z=2
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776,z=3
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463,z=4


----------------------------------------------------------------
mlr --from u/s.dkvp put $z = 0; do {$z += 1} while ($z < $i)
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533,z=1
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797,z=2
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776,z=3
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463,z=4


----------------------------------------------------------------
mlr --from u/s.dkvp put $z = 10; while ($z < $i) {$z += 1}
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533,z=10
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797,z=10
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776,z=10
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463,z=10


----------------------------------------------------------------
mlr --from u/s.dkvp put $z = 10; do {$z += 1} while ($z < $i)
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533,z=11
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797,z=11
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776,z=11
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463,z=11


----------------------------------------------------------------
mlr --from u/s.dkvp head -n 1 then put -q for (k in [3,4,5]) { emit { "foo" : "bar" } }
foo=bar
foo=bar
foo=bar


----------------------------------------------------------------
mlr --from u/s.dkvp head -n 1 then put -q for (k in [3,4,5]) { emit { "foo" : k } }
foo=1
foo=2
foo=3


----------------------------------------------------------------
mlr --from u/s.dkvp head -n 1 then put -q for (k,v in [3,4,5]) { emit { "foo" : "bar" } }
foo=bar
foo=bar
foo=bar


----------------------------------------------------------------
mlr --from u/s.dkvp head -n 1 then put -q for (k,v in [3,4,5]) { emit { "foo" : k } }
foo=1
foo=2
foo=3


----------------------------------------------------------------
mlr --from u/s.dkvp head -n 1 then put -q for (k,v in [3,4,5]) { emit { "foo" : v } }
foo=3
foo=4
foo=5


----------------------------------------------------------------
mlr --from u/s.dkvp put nr=NR; $nr=nr
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533,nr=1
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797,nr=2
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776,nr=3
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463,nr=4


----------------------------------------------------------------
mlr --from u/s.dkvp put 
  z = 1;
  if (NR <= 2) {
    z = 2;
  } else {
    z = 3;
  }
  $z = z

a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533,z=2
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797,z=2
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776,z=3
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463,z=3


----------------------------------------------------------------
mlr --from u/s.dkvp put for (@i = 0; @i < NR; @i += 1) { $i += @i }
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533
a=eks,b=pan,i=3,x=0.7586799647899636,y=0.5221511083334797
a=wye,b=wye,i=6,x=0.20460330576630303,y=0.33831852551664776
a=eks,b=wye,i=10,x=0.38139939387114097,y=0.13418874328430463


----------------------------------------------------------------
mlr --from u/s.dkvp put i=999; for (i = 0; i < NR; i += 1) { $i += i }
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533
a=eks,b=pan,i=3,x=0.7586799647899636,y=0.5221511083334797
a=wye,b=wye,i=6,x=0.20460330576630303,y=0.33831852551664776
a=eks,b=wye,i=10,x=0.38139939387114097,y=0.13418874328430463


----------------------------------------------------------------
mlr --from u/s.dkvp put -v j = 2; for (i = 0; i < NR; i += 1) { $i += i }
DSL EXPRESSION:
j = 2; for (i = 0; i < NR; i += 1) { $i += i }
RAW AST:
* statement block
    * assignment "="
        * local variable "j"
        * int literal "2"
    * triple-for loop "for"
        * statement block
            * assignment "="
                * local variable "i"
                * int literal "0"
        * statement block
            * bare boolean
                * operator "<"
                    * local variable "i"
                    * context variable "NR"
        * statement block
            * assignment "="
                * local variable "i"
                * operator "+"
                    * local variable "i"
                    * int literal "1"
        * statement block
            * assignment "="
                * direct field value "i"
                * operator "+"
                    * direct field value "i"
                    * local variable "i"

a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533
a=eks,b=pan,i=3,x=0.7586799647899636,y=0.5221511083334797
a=wye,b=wye,i=6,x=0.20460330576630303,y=0.33831852551664776
a=eks,b=wye,i=10,x=0.38139939387114097,y=0.13418874328430463


----------------------------------------------------------------
mlr --from u/ten.dkvp --opprint put $z=sec2gmt($i)
a   b   i  x                   y                   z
pan pan 1  0.3467901443380824  0.7268028627434533  1970-01-01T00:00:01Z
eks pan 2  0.7586799647899636  0.5221511083334797  1970-01-01T00:00:02Z
wye wye 3  0.20460330576630303 0.33831852551664776 1970-01-01T00:00:03Z
eks wye 4  0.38139939387114097 0.13418874328430463 1970-01-01T00:00:04Z
wye pan 5  0.5732889198020006  0.8636244699032729  1970-01-01T00:00:05Z
zee pan 6  0.5271261600918548  0.49322128674835697 1970-01-01T00:00:06Z
eks zee 7  0.6117840605678454  0.1878849191181694  1970-01-01T00:00:07Z
zee wye 8  0.5985540091064224  0.976181385699006   1970-01-01T00:00:08Z
hat wye 9  0.03144187646093577 0.7495507603507059  1970-01-01T00:00:09Z
pan wye 10 0.5026260055412137  0.9526183602969864  1970-01-01T00:00:10Z


----------------------------------------------------------------
mlr --from u/ten.dkvp --opprint put $z=sec2gmt($i, $i-1)
a   b   i  x                   y                   z
pan pan 1  0.3467901443380824  0.7268028627434533  1970-01-01T00:00:01Z
eks pan 2  0.7586799647899636  0.5221511083334797  1970-01-01T00:00:02.0Z
wye wye 3  0.20460330576630303 0.33831852551664776 1970-01-01T00:00:03.00Z
eks wye 4  0.38139939387114097 0.13418874328430463 1970-01-01T00:00:04.000Z
wye pan 5  0.5732889198020006  0.8636244699032729  1970-01-01T00:00:05.0000Z
zee pan 6  0.5271261600918548  0.49322128674835697 1970-01-01T00:00:06.00000Z
eks zee 7  0.6117840605678454  0.1878849191181694  1970-01-01T00:00:07.000000Z
zee wye 8  0.5985540091064224  0.976181385699006   1970-01-01T00:00:08.0000000Z
hat wye 9  0.03144187646093577 0.7495507603507059  1970-01-01T00:00:09.00000000Z
pan wye 10 0.5026260055412137  0.9526183602969864  1970-01-01T00:00:10.000000000Z


----------------------------------------------------------------
mlr --from u/ten.dkvp --opprint put $z=sec2gmt($i+0.123456789)
a   b   i  x                   y                   z
pan pan 1  0.3467901443380824  0.7268028627434533  1970-01-01T00:00:01Z
eks pan 2  0.7586799647899636  0.5221511083334797  1970-01-01T00:00:02Z
wye wye 3  0.20460330576630303 0.33831852551664776 1970-01-01T00:00:03Z
eks wye 4  0.38139939387114097 0.13418874328430463 1970-01-01T00:00:04Z
wye pan 5  0.5732889198020006  0.8636244699032729  1970-01-01T00:00:05Z
zee pan 6  0.5271261600918548  0.49322128674835697 1970-01-01T00:00:06Z
eks zee 7  0.6117840605678454  0.1878849191181694  1970-01-01T00:00:07Z
zee wye 8  0.5985540091064224  0.976181385699006   1970-01-01T00:00:08Z
hat wye 9  0.03144187646093577 0.7495507603507059  1970-01-01T00:00:09Z
pan wye 10 0.5026260055412137  0.9526183602969864  1970-01-01T00:00:10Z


----------------------------------------------------------------
mlr --from u/ten.dkvp --opprint put $z=sec2gmt($i+0.123456789,$i-1)
a   b   i  x                   y                   z
pan pan 1  0.3467901443380824  0.7268028627434533  1970-01-01T00:00:01Z
eks pan 2  0.7586799647899636  0.5221511083334797  1970-01-01T00:00:02.1Z
wye wye 3  0.20460330576630303 0.33831852551664776 1970-01-01T00:00:03.12Z
eks wye 4  0.38139939387114097 0.13418874328430463 1970-01-01T00:00:04.123Z
wye pan 5  0.5732889198020006  0.8636244699032729  1970-01-01T00:00:05.1234Z
zee pan 6  0.5271261600918548  0.49322128674835697 1970-01-01T00:00:06.12345Z
eks zee 7  0.6117840605678454  0.1878849191181694  1970-01-01T00:00:07.123456Z
zee wye 8  0.5985540091064224  0.976181385699006   1970-01-01T00:00:08.1234567Z
hat wye 9  0.03144187646093577 0.7495507603507059  1970-01-01T00:00:09.12345678Z
pan wye 10 0.5026260055412137  0.9526183602969864  1970-01-01T00:00:10.123456789Z

{
  "x": " a     b ",
  "y": "a     b"
}

{
  "x": " a     b ",
  "y": "a     b "
}

{
  "x": " a     b ",
  "y": " a     b"
}

{
  "x": " a     b ",
  "y": " a b "
}

{
  "x": " a     b ",
  "y": "a b"
}


----------------------------------------------------------------
mlr --from u/s.dkvp put $z = strlen($a)
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533,z=3
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797,z=3
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776,z=3
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463,z=3


----------------------------------------------------------------
mlr put $y = substr($x, 0, 0)
x=abcdefg,y=


----------------------------------------------------------------
mlr put $y = substr($x, 0, 7)
x=abcdefg,y=


----------------------------------------------------------------
mlr put $y = substr($x, 1, 7)
x=abcdefg,y=abcdefg


----------------------------------------------------------------
mlr put $y = substr($x, 1, 6)
x=abcdefg,y=abcdef


----------------------------------------------------------------
mlr put $y = substr($x, 2, 5)
x=abcdefg,y=bcde


----------------------------------------------------------------
mlr put $y = substr($x, 2, 3)
x=abcdefg,y=bc


----------------------------------------------------------------
mlr put $y = substr($x, 3, 3)
x=abcdefg,y=c


----------------------------------------------------------------
mlr put $y = substr($x, 4, 3)
x=abcdefg,y=


----------------------------------------------------------------
mlr put $n = length($x)
x=1,y=abcdefg,z=3,n=1


----------------------------------------------------------------
mlr put $n = length($y)
x=1,y=abcdefg,z=3,n=1


----------------------------------------------------------------
mlr put $n = length($nonesuch)
x=1,y=abcdefg,z=3,n=0


----------------------------------------------------------------
mlr put $n = length($*)
x=1,y=abcdefg,z=3,n=3


----------------------------------------------------------------
mlr put $n = length([])
x=1,y=abcdefg,z=3,n=0


----------------------------------------------------------------
mlr put $n = length([5,6,7])
x=1,y=abcdefg,z=3,n=3


----------------------------------------------------------------
mlr put $n = length({})
x=1,y=abcdefg,z=3,n=0


----------------------------------------------------------------
mlr put $n = length({"a":5,"b":6,"c":7})
x=1,y=abcdefg,z=3,n=3


----------------------------------------------------------------
mlr --from u/s.dkvp put $si = 0; for (i = 0; i < NR; i += 1) { if (i == 2) { $si += 0   } $si += i }
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533,si=0
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797,si=1
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776,si=3
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463,si=6


----------------------------------------------------------------
mlr --from u/s.dkvp put $si = 0; for (i = 0; i < NR; i += 1) { if (i == 2) { $si += 100 } $si += i }
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533,si=0
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797,si=1
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776,si=103
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463,si=106


----------------------------------------------------------------
mlr --from u/s.dkvp put $si = 0; for (i = 0; i < NR; i += 1) { if (i == 2) { break }      $si += i }
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533,si=0
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797,si=1
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776,si=1
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463,si=1


----------------------------------------------------------------
mlr --from u/s.dkvp put $si = 0; for (i = 0; i < NR; i += 1) { if (i == 2) { continue }   $si += i }
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533,si=0
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797,si=1
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776,si=1
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463,si=4


----------------------------------------------------------------
mlr --from u/s.dkvp --opprint put 
  $si = 0;
  for (i = 0; i < NR; i += 1) {
    if (true) {
      if (i == 2) {
        $si += 0
      }
    }
    $si += i
  }
a   b   i x                   y                   si
pan pan 1 0.3467901443380824  0.7268028627434533  0
eks pan 2 0.7586799647899636  0.5221511083334797  1
wye wye 3 0.20460330576630303 0.33831852551664776 3
eks wye 4 0.38139939387114097 0.13418874328430463 6


----------------------------------------------------------------
mlr --from u/s.dkvp --opprint put 
  $si = 0;
  for (i = 0; i < NR; i += 1) {
    if (true) {
      if (i == 2) {
        $si += 100
      }
    }
    $si += i
  }
a   b   i x                   y                   si
pan pan 1 0.3467901443380824  0.7268028627434533  0
eks pan 2 0.7586799647899636  0.5221511083334797  1
wye wye 3 0.20460330576630303 0.33831852551664776 103
eks wye 4 0.38139939387114097 0.13418874328430463 106


----------------------------------------------------------------
mlr --from u/s.dkvp --opprint put 
  $si = 0;
  for (i = 0; i < NR; i += 1) {
    if (true) {
      if (i == 2) {
        break
      }
    }
    $si += i
  }
a   b   i x                   y                   si
pan pan 1 0.3467901443380824  0.7268028627434533  0
eks pan 2 0.7586799647899636  0.5221511083334797  1
wye wye 3 0.20460330576630303 0.33831852551664776 1
eks wye 4 0.38139939387114097 0.13418874328430463 1


----------------------------------------------------------------
mlr --from u/s.dkvp --opprint put 
  $si = 0;
  for (i = 0; i < NR; i += 1) {
    if (true) {
      if (i == 2) {
        continue
      }
    }
    $si += i
  }
a   b   i x                   y                   si
pan pan 1 0.3467901443380824  0.7268028627434533  0
eks pan 2 0.7586799647899636  0.5221511083334797  1
wye wye 3 0.20460330576630303 0.33831852551664776 1
eks wye 4 0.38139939387114097 0.13418874328430463 4


----------------------------------------------------------------
mlr --from u/s.dkvp --opprint put 
  $si = 0;
  for (p = 1; p <= 3; p += 1) {
    for (i = 0; i < NR; i += 1) {
      if (i == 2) {
        $si += 0
      }
      $si += i * 10**p
    }
  }
a   b   i x                   y                   si
pan pan 1 0.3467901443380824  0.7268028627434533  0
eks pan 2 0.7586799647899636  0.5221511083334797  1110
wye wye 3 0.20460330576630303 0.33831852551664776 3330
eks wye 4 0.38139939387114097 0.13418874328430463 6660


----------------------------------------------------------------
mlr --from u/s.dkvp --opprint put 
  $si = 0;
  for (p = 1; p <= 3; p += 1) {
    for (i = 0; i < NR; i += 1) {
      if (i == 2) {
        break
      }
      $si += i * 10**p
    }
  }
a   b   i x                   y                   si
pan pan 1 0.3467901443380824  0.7268028627434533  0
eks pan 2 0.7586799647899636  0.5221511083334797  1110
wye wye 3 0.20460330576630303 0.33831852551664776 1110
eks wye 4 0.38139939387114097 0.13418874328430463 1110


----------------------------------------------------------------
mlr --from u/s.dkvp --opprint put 
  $si = 0;
  for (p = 1; p <= 3; p += 1) {
    for (i = 0; i < NR; i += 1) {
      if (i == 2) {
        continue
      }
      $si += i * 10**p
    }
  }
a   b   i x                   y                   si
pan pan 1 0.3467901443380824  0.7268028627434533  0
eks pan 2 0.7586799647899636  0.5221511083334797  1110
wye wye 3 0.20460330576630303 0.33831852551664776 1110
eks wye 4 0.38139939387114097 0.13418874328430463 4440


----------------------------------------------------------------
mlr --opprint --from u/ten.dkvp put -f u/f.mlr
a   b   i  x                   y                   z
pan pan 1  0.3467901443380824  0.7268028627434533  1.0735930070815356
eks pan 2  0.7586799647899636  0.5221511083334797  1.2808310731234434
wye wye 3  0.20460330576630303 0.33831852551664776 0.5429218312829508
eks wye 4  0.38139939387114097 0.13418874328430463 0.5155881371554456
wye pan 5  0.5732889198020006  0.8636244699032729  1.4369133897052735
zee pan 6  0.5271261600918548  0.49322128674835697 1.0203474468402116
eks zee 7  0.6117840605678454  0.1878849191181694  0.7996689796860148
zee wye 8  0.5985540091064224  0.976181385699006   1.5747353948054283
hat wye 9  0.03144187646093577 0.7495507603507059  0.7809926368116417
pan wye 10 0.5026260055412137  0.9526183602969864  1.4552443658382002


----------------------------------------------------------------
mlr --opprint --from u/ten.dkvp put -f u/ff.mlr
a   b   i  x                   y
pan pan 1  0.3467901443380824  1
eks pan 2  0.7586799647899636  2
wye wye 3  0.20460330576630303 6
eks wye 4  0.38139939387114097 24
wye pan 5  0.5732889198020006  120
zee pan 6  0.5271261600918548  720
eks zee 7  0.6117840605678454  5040
zee wye 8  0.5985540091064224  40320
hat wye 9  0.03144187646093577 362880
pan wye 10 0.5026260055412137  3628800


----------------------------------------------------------------
mlr --opprint --from u/ten.dkvp put -f u/fg.mlr
a   b   i  x                   y                   fg  gf
pan pan 1  0.3467901443380824  0.7268028627434533  9   3
eks pan 2  0.7586799647899636  0.5221511083334797  36  12
wye wye 3  0.20460330576630303 0.33831852551664776 81  27
eks wye 4  0.38139939387114097 0.13418874328430463 144 48
wye pan 5  0.5732889198020006  0.8636244699032729  225 75
zee pan 6  0.5271261600918548  0.49322128674835697 324 108
eks zee 7  0.6117840605678454  0.1878849191181694  441 147
zee wye 8  0.5985540091064224  0.976181385699006   576 192
hat wye 9  0.03144187646093577 0.7495507603507059  729 243
pan wye 10 0.5026260055412137  0.9526183602969864  900 300

----------------------------------------------------------------
mlr --from u/s.dkvp put var x = 3
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463

----------------------------------------------------------------
mlr --from u/s.dkvp put int x = 3
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463

----------------------------------------------------------------
mlr --from u/s.dkvp put num x = 3
a=pan,b=pan,i=1,x=0.3467901443380824,y=0.7268028627434533
a=eks,b=pan,i=2,x=0.7586799647899636,y=0.5221511083334797
a=wye,b=wye,i=3,x=0.20460330576630303,y=0.33831852551664776
a=eks,b=wye,i=4,x=0.38139939387114097,y=0.13418874328430463
mlr --from u/s.dkvp put str x = 3
Miller: couldn't assign variable str x from value int 3
mlr --from u/s.dkvp put arr x = 3
Miller: couldn't assign variable arr x from value int 3

----------------------------------------------------------------
mlr --from u/s.dkvp put func f(var x) { return 2*x} $y=f(3)
a=pan,b=pan,i=1,x=0.3467901443380824,y=6
a=eks,b=pan,i=2,x=0.7586799647899636,y=6
a=wye,b=wye,i=3,x=0.20460330576630303,y=6
a=eks,b=wye,i=4,x=0.38139939387114097,y=6

----------------------------------------------------------------
mlr --from u/s.dkvp put func f(int x) { return 2*x} $y=f(3)
a=pan,b=pan,i=1,x=0.3467901443380824,y=6
a=eks,b=pan,i=2,x=0.7586799647899636,y=6
a=wye,b=wye,i=3,x=0.20460330576630303,y=6
a=eks,b=wye,i=4,x=0.38139939387114097,y=6

----------------------------------------------------------------
mlr --from u/s.dkvp put func f(num x) { return 2*x} $y=f(3)
a=pan,b=pan,i=1,x=0.3467901443380824,y=6
a=eks,b=pan,i=2,x=0.7586799647899636,y=6
a=wye,b=wye,i=3,x=0.20460330576630303,y=6
a=eks,b=wye,i=4,x=0.38139939387114097,y=6
mlr --from u/s.dkvp put func f(str x) { return 2*x} $y=f(3)
Miller: couldn't assign variable str x from value int 3
mlr --from u/s.dkvp put func f(arr x) { return 2*x} $y=f(3)
Miller: couldn't assign variable arr x from value int 3

----------------------------------------------------------------
mlr --from u/s.dkvp put func f(x): var { return 2*x} $y=f(3)
a=pan,b=pan,i=1,x=0.3467901443380824,y=6
a=eks,b=pan,i=2,x=0.7586799647899636,y=6
a=wye,b=wye,i=3,x=0.20460330576630303,y=6
a=eks,b=wye,i=4,x=0.38139939387114097,y=6

----------------------------------------------------------------
mlr --from u/s.dkvp put func f(x): int { return 2*x} $y=f(3)
a=pan,b=pan,i=1,x=0.3467901443380824,y=6
a=eks,b=pan,i=2,x=0.7586799647899636,y=6
a=wye,b=wye,i=3,x=0.20460330576630303,y=6
a=eks,b=wye,i=4,x=0.38139939387114097,y=6

----------------------------------------------------------------
mlr --from u/s.dkvp put func f(x): num { return 2*x} $y=f(3)
a=pan,b=pan,i=1,x=0.3467901443380824,y=6
a=eks,b=pan,i=2,x=0.7586799647899636,y=6
a=wye,b=wye,i=3,x=0.20460330576630303,y=6
a=eks,b=wye,i=4,x=0.38139939387114097,y=6
mlr --from u/s.dkvp put func f(x): str { return 2*x} $y=f(3)
Miller: couldn't assign variable str function return value from value int 6
mlr --from u/s.dkvp put func f(x): arr { return 2*x} $y=f(3)
Miller: couldn't assign variable arr function return value from value int 6

----------------------------------------------------------------
mlr --idkvp --opprint --from u/s.dkvp put 
  for (k, v in $*) {
    $["t".k] = typeof(v)
  }
  $tnonesuch = typeof($nonesuch)

a   b   i x                   y                   ta  tb  ti  tx    ty    tnonesuch
pan pan 1 0.3467901443380824  0.7268028627434533  str str int float float absent
eks pan 2 0.7586799647899636  0.5221511083334797  str str int float float absent
wye wye 3 0.20460330576630303 0.33831852551664776 str str int float float absent
eks wye 4 0.38139939387114097 0.13418874328430463 str str int float float absent

----------------------------------------------------------------
mlr --idkvp --opprint --from u/s.dkvp put 
  for (k, v in $*) {
    $["s".k] = string(v)
  }
  $snonesuch = string($nonesuch)

a   b   i x                   y                   sa  sb  si sx                  sy                  snonesuch
pan pan 1 0.3467901443380824  0.7268028627434533  pan pan 1  0.3467901443380824  0.7268028627434533  (absent)
eks pan 2 0.7586799647899636  0.5221511083334797  eks pan 2  0.7586799647899636  0.5221511083334797  (absent)
wye wye 3 0.20460330576630303 0.33831852551664776 wye wye 3  0.20460330576630303 0.33831852551664776 (absent)
eks wye 4 0.38139939387114097 0.13418874328430463 eks wye 4  0.38139939387114097 0.13418874328430463 (absent)

----------------------------------------------------------------
mlr --j2p --from u/typecast.json put 
  $t       = typeof($a);
  $string  = string($a);
  $int     = int($a);
  $float   = float($a);
  $boolean = boolean($a);
 then reorder -f t,a
t     a     string int     float   boolean
str   abc   abc    (error) (error) (error)
int   0     0      0       0       false
int   2     2      2       2       true
float 0.0   0.0    0       0.0     false
float 2.3   2.3    2       2.3     true
bool  false false  0       0       false
bool  true  true   1       1       true
str   0     0      0       0       (error)
str   2     2      2       2       (error)
str   0.0   0.0    (error) 0       (error)
str   2.3   2.3    (error) 2.3     (error)
str   false false  (error) (error) false
str   true  true   (error) (error) true

----------------------------------------------------------------
mlr -n put -f u/sieve.mlr
2
3
5
7
11
13
17
19
23
29
31
37
41
43
47
53
59
61
67
71
73
79
83
89
97

----------------------------------------------------------------
mlr --from /dev/null put -f u/sieve.mlr
2
3
5
7
11
13
17
19
23
29
31
37
41
43
47
53
59
61
67
71
73
79
83
89
97

----------------------------------------------------------------
mlr --from u/s.dkvp put -q -f u/sieve.mlr
2
3
5
7
11
13
17
19
23
29
31
37
41
43
47
53
59
61
67
71
73
79
83
89
97
mlr -n put begin{begin{}}
Miller: begin blocks can only be at top level.
mlr -n put begin{end{}}
Miller: end blocks can only be at top level.
mlr -n put end{begin{}}
Miller: begin blocks can only be at top level.
mlr -n put end{end{}}
Miller: end blocks can only be at top level.
mlr -n put begin { func f(x) { return 2*x} }
Miller: func blocks can only be at top level.
mlr -n put begin { emit $x }
Miller: begin/end blocks cannot refer to records via $x, $*, etc.
mlr -n put return 3
Miller: return statements are only valid within func/subr blocks.
mlr -n put break
Miller: break statements are only valid within for/do/while loops.
mlr -n put continue
Miller: break statements are only valid within for/do/while loops.
mlr -n put func f() { break }
Miller: break statements are only valid within for/do/while loops.
mlr -n put func f() { continue }
Miller: break statements are only valid within for/do/while loops.
